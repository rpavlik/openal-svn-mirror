CC=@CC@
CFLAGS=@CFLAGS@
TEST_PROGS=test
T_OBJS=test.o
AC_OBJS=ac_bits.o               \
	ac_freq.o               \
	ac_helper.o             \
	ac_channels.o           \
	ac_endian.o             \
	ac_adpcm.o              \
	ac_misc.o
LIN_OBJS=
AC_OBJS+=
LIBS=-L. -laudioconvert @LIBS@
INC=-I../include -I../../include -I../src @INCLUDES@
MAJOR_VERSION=@MAJOR_VERSION@
MINOR_VERSION=@MINOR_VERSION@
MICRO_VERSION=@MICRO_VERSION@
VERSION=$(MAJOR_VERSION).$(MINOR_VERSION).$(MICRO_VERSION)

SUBDIRS :=
RM_RF := $(RM) -r
CLEAN_FILES := $(AC_OBJS) $(wildcard libaudioconvert.*) $(T_OBJS) $(TEST_PROGS)
DISTCLEAN_FILES := Makefile
MAINTAINER_CLEAN_FILES :=
REPO_CLEAN_FILES :=

.SUFFIXES: .c .o
%.o : %.c ../config.h
	$(CC) $(INC) -fPIC -DPIC $(CFLAGS) -c $< -o $@

all: libaudioconvert $(TEST_PROGS)

libaudioconvert: libaudioconvert.a libaudioconvert.so

libaudioconvert.a: $(AC_OBJS)
	ar cru libaudioconvert.a $(AC_OBJS)

libaudioconvert.so: $(AC_OBJS)
	$(CC) -shared -o libaudioconvert.so.$(VERSION) $(AC_OBJS)

test: libaudioconvert $(T_OBJS)
	$(CC) $(CFLAGS) -o test $(T_OBJS) $(LIBS)

clean:
	for i in "" $(SUBDIRS) ; do test -z "$$i" || ( cd $$i && $(MAKE) clean ) done
	$(RM_RF) __rm_food $(CLEAN_FILES)

distclean:
	for i in "" $(SUBDIRS) ; do test -z "$$i" || ( cd $$i && $(MAKE) distclean ) done
	$(RM_RF) __rm_food $(CLEAN_FILES) $(DISTCLEAN_FILES)

maintainer-clean:
	for i in "" $(SUBDIRS) ; do test -z "$$i" || ( cd $$i && $(MAKE) maintainer-clean ) done
	$(RM_RF) __rm_food $(CLEAN_FILES) $(DISTCLEAN_FILES) $(MAINTAINER_CLEAN_FILES)

repo-clean:
	for i in "" $(SUBDIRS) ; do test -z "$$i" || ( cd $$i && $(MAKE) repo-clean ) done
	$(RM_RF) __rm_food $(CLEAN_FILES) $(DISTCLEAN_FILES) $(MAINTAINER_CLEAN_FILES) $(REPO_CLEAN_FILES)
